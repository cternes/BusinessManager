<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:sec="http://www.springframework.org/schema/security"
	xmlns:tx="http://www.springframework.org/schema/tx"
	xmlns:context="http://www.springframework.org/schema/context"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
		http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd
		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
        http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.0.xsd">

	<!-- Scans within the base package of the application for @Components to 
		configure as beans -->
	<import resource="test-db.xml" />
	<tx:annotation-driven />
	<context:component-scan base-package="ch.vqf.cp" />	

	<sec:global-method-security pre-post-annotations="enabled" secured-annotations="enabled" />
	
	<sec:authentication-manager>
		<sec:authentication-provider user-service-ref="userDetailsService" />
	</sec:authentication-manager>
	
	<bean id="userDetailsService" class="ch.vqf.cp.test.MockUserDetailsService" />
	
	<bean id="storageManager" class="ch.vqf.cp.startup.StorageManager">
		<property name="storageMap">
			<map>
				<entry key-ref="mitgliedProvider" value-ref="mitgliedStrategy"></entry>
				<entry key-ref="prueferProvider" value-ref="prueferStrategy"></entry>
				<entry key-ref="benutzerProvider" value-ref="benutzerStrategy"></entry>
				<entry key-ref="permissionProvider" value-ref="permissionStrategy"></entry>
				<entry key-ref="roleProvider" value-ref="roleStrategy"></entry>
				<entry key-ref="pruefungProvider" value-ref="pruefungStrategy"></entry>
			</map>
		</property>
	</bean>
	
	<bean id="mitgliedProvider" class="ch.vqf.cp.startup.provider.DefaultProvider">
		<property name="objectList">
			<list>
				<ref bean="mitglied1" />
				<ref bean="mitglied2" />
			</list>
		</property>
	</bean>
	
	<bean id="mitglied1" class="ch.vqf.cp.domain.Mitglied">
    	<property name="mitgliedsnummer" value="11409"></property>
    	<property name="mitgliedsname" value="XY AG"></property>
    	<property name="adressen">
			<list>
				<ref bean="adresse1"></ref>
			</list>    		
    	</property>
    </bean>
    
    <bean id="mitglied2" class="ch.vqf.cp.domain.Mitglied">
    	<property name="mitgliedsnummer" value="12579"></property>
    	<property name="mitgliedsname" value="YZ AG"></property>
    	<property name="adressen">
			<list>
				<ref bean="adresse2"></ref>
			</list>    		
    	</property>
    </bean>
    
    <bean id="mitgliedStrategy" class="ch.vqf.cp.startup.strategy.MitgliedStrategy" />
    
    <bean id="prueferProvider" class="ch.vqf.cp.startup.provider.DefaultProvider">
		<property name="objectList">
			<list>
				<ref bean="pruefer1" />
				<ref bean="pruefer2" />
			</list>
		</property>
	</bean>
	
	<bean id="pruefer1" class="ch.vqf.cp.domain.Pruefer">
    	<property name="vorname" value="Felix"></property>
    	<property name="nachname" value="Freitag"></property>
    </bean>
    
    <bean id="pruefer2" class="ch.vqf.cp.domain.Pruefer">
    	<property name="vorname" value="Martin"></property>
    	<property name="nachname" value="Maier"></property>
    </bean>
    
    <bean id="prueferStrategy" class="ch.vqf.cp.startup.strategy.PrueferStrategy" />
    
     <bean id="benutzerProvider" class="ch.vqf.cp.startup.provider.DefaultProvider">
		<property name="objectList">
			<list>
				<ref bean="benutzer1" />
				<ref bean="benutzer2" />
				<ref bean="benutzer3" />
				<ref bean="benutzer4" />
				<ref bean="benutzer5" />
				<ref bean="benutzerAdmin" />
			</list>
		</property>
	</bean>
    
    <bean id="benutzer1" class="ch.vqf.cp.domain.security.User">
    	<property name="username" value="felixfreitag"></property>
    	<property name="password" value="felixfreitag"></property>
    	<property name="enabled" value="true"></property>
		<property name="email" value="felix.freitag@vqf.ch"></property>
		<property name="mustChangePassword" value="false"></property>
		<property name="pruefer" ref="pruefer1"></property>
    </bean>
    
    <bean id="benutzer2" class="ch.vqf.cp.domain.security.User">
    	<property name="username" value="martinmaier"></property>
    	<property name="password" value="martinmaier"></property>
    	<property name="enabled" value="true"></property>
		<property name="email" value="martin.maier@vqf.ch"></property>
		<property name="mustChangePassword" value="false"></property>
		<property name="pruefer" ref="pruefer2"></property>
    </bean>
    
    <bean id="benutzer3" class="ch.vqf.cp.domain.security.User">
    	<property name="username" value="4711"></property>
    	<property name="password" value="4711"></property>
    	<property name="enabled" value="true"></property>
		<property name="email" value="info@xyag.ch"></property>
		<property name="mustChangePassword" value="false"></property>
		<property name="mitglied" ref="mitglied1"></property>
    </bean>
    
    <bean id="benutzer4" class="ch.vqf.cp.domain.security.User">
    	<property name="username" value="4723"></property>
    	<property name="password" value="4723"></property>
    	<property name="enabled" value="true"></property>
		<property name="email" value="info@yzag.ch"></property>
		<property name="mustChangePassword" value="false"></property>
		<property name="mitglied" ref="mitglied2"></property>
    </bean>
    
    <bean id="benutzer5" class="ch.vqf.cp.domain.security.User">
    	<property name="username" value="revisorat"></property>
    	<property name="password" value="revisorat"></property>
    	<property name="enabled" value="true"></property>
		<property name="email" value="revisorat@vqf.ch"></property>
		<property name="mustChangePassword" value="false"></property>
    </bean>
     
    <bean id="benutzerAdmin" class="ch.vqf.cp.domain.security.User">
    	<property name="username" value="admin"></property>
    	<property name="password" value="admin"></property>
    	<property name="enabled" value="true"></property>
		<property name="email" value="admin@vqf.ch"></property>
		<property name="mustChangePassword" value="false"></property>
    </bean>
    
    <bean id="benutzerStrategy" class="ch.vqf.cp.startup.strategy.UserStrategy" />

	<bean id="permissionProvider" class="ch.vqf.cp.startup.provider.DefaultProvider">
		<property name="objectList">
			<list>
				<ref bean="perm1" />
				<ref bean="perm2" />
				<ref bean="perm3" />
				<ref bean="perm4" />
				<ref bean="perm5" />
				<ref bean="perm6" />
				<ref bean="perm7" />
				<ref bean="perm8" />
				<ref bean="perm9" />
				<ref bean="perm10" />
				<ref bean="perm11" />
				<ref bean="perm12" />
				<ref bean="perm13" />
				<ref bean="perm14" />
				<ref bean="perm15" />
				<ref bean="perm16" />
				<ref bean="perm17" />
				<ref bean="perm18" />
			</list>
		</property>
	</bean>

	<bean id="perm1" class="ch.vqf.cp.domain.security.Permission">
    	<property name="name" value="Administratorrecht"></property>
    </bean>
    
    <bean id="perm2" class="ch.vqf.cp.domain.security.Permission">
    	<property name="name" value="Rollen hinzufügen"></property>
    </bean>
    
    <bean id="perm3" class="ch.vqf.cp.domain.security.Permission">
    	<property name="name" value="Rollen löschen"></property>
    </bean>
    
    <bean id="perm4" class="ch.vqf.cp.domain.security.Permission">
    	<property name="name" value="Navigation Selbstdeklaration"></property>
    </bean>
    
    <bean id="perm5" class="ch.vqf.cp.domain.security.Permission">
    	<property name="name" value="Navigation Stammdatenmutation"></property>
    </bean>
    
    <bean id="perm6" class="ch.vqf.cp.domain.security.Permission">
    	<property name="name" value="Navigation Prüfungen"></property>
    </bean>
    
    <bean id="perm7" class="ch.vqf.cp.domain.security.Permission">
    	<property name="name" value="Navigation Aktuelle Prüfung"></property>
    </bean>
    
    <bean id="perm8" class="ch.vqf.cp.domain.security.Permission">
    	<property name="name" value="Navigation Vereinbarte Prüfungen"></property>
    </bean>
    
    <bean id="perm9" class="ch.vqf.cp.domain.security.Permission">
    	<property name="name" value="Navigation Terminkalender"></property>
    </bean>
    
    <bean id="perm10" class="ch.vqf.cp.domain.security.Permission">
    	<property name="name" value="Navigation Prüfer"></property>
    </bean>
    
    <bean id="perm11" class="ch.vqf.cp.domain.security.Permission">
    	<property name="name" value="Navigation Grundausbildung"></property>
    </bean>
    
    <bean id="perm12" class="ch.vqf.cp.domain.security.Permission">
    	<property name="name" value="Navigation Weiterbildung"></property>
    </bean>
    
    <bean id="perm13" class="ch.vqf.cp.domain.security.Permission">
    	<property name="name" value="Navigation Aus-Weiterbildung"></property>
    </bean>
    
    <bean id="perm14" class="ch.vqf.cp.domain.security.Permission">
    	<property name="name" value="Navigation Mutation-Erstellen"></property>
    </bean>
    
    <bean id="perm15" class="ch.vqf.cp.domain.security.Permission">
    	<property name="name" value="Navigation ListeOffenerMutationen"></property>
    </bean>
    
    <bean id="perm16" class="ch.vqf.cp.domain.security.Permission">
    	<property name="name" value="Navigation Controlling"></property>
    </bean>
    
    <bean id="perm17" class="ch.vqf.cp.domain.security.Permission">
    	<property name="name" value="Navigation Budgetierung"></property>
    </bean>
    
    <bean id="perm18" class="ch.vqf.cp.domain.security.Permission">
    	<property name="name" value="Navigation Administration"></property>
    </bean>
    
    <bean id="permissionStrategy" class="ch.vqf.cp.startup.strategy.PermissionStrategy" />
    
    <bean id="roleProvider" class="ch.vqf.cp.startup.provider.DefaultProvider">
		<property name="objectList">
			<list>
				<ref bean="roleAdmin" />
				<ref bean="roleMitglied" />
				<ref bean="rolePruefer" />
				<ref bean="roleRevisorat" />
			</list>
		</property>
	</bean>
    
    <bean id="roleAdmin" class="ch.vqf.cp.domain.security.Role">
    	<property name="name" value="Administrator"></property>
    	<property name="members">
    		<list>
				<ref bean="benutzerAdmin"></ref>
    		</list>
    	</property>
    	<property name="permissions">
    		<list>
    			<ref bean="perm1"></ref>
    		</list>
    	</property>
    </bean>
    
    <bean id="roleMitglied" class="ch.vqf.cp.domain.security.Role">
    	<property name="name" value="VqfMitglied"></property>
    	<property name="members">
    		<list>
				<ref bean="benutzer3"></ref>
				<ref bean="benutzer4"></ref>    		
    		</list>
    	</property>
    	<property name="permissions">
    		<list>
    			<ref bean="perm4"></ref>
    			<ref bean="perm5"></ref>
    			<ref bean="perm7"></ref>
    			<ref bean="perm8"></ref>
    			<ref bean="perm11"></ref>
    			<ref bean="perm12"></ref>
    			<ref bean="perm13"></ref>
    			<ref bean="perm14"></ref>
    			<ref bean="perm15"></ref>
    		</list>
    	</property>
    </bean>
    
    <bean id="rolePruefer" class="ch.vqf.cp.domain.security.Role">
    	<property name="name" value="Prüfer"></property>
    	<property name="members">
    		<list>
				<ref bean="benutzer1"></ref>
				<ref bean="benutzer2"></ref>    		
    		</list>
    	</property>
    	<property name="permissions">
    		<list>
    			<ref bean="perm7"></ref>
    			<ref bean="perm9"></ref>
    			<ref bean="perm10"></ref>
    		</list>
    	</property>
    </bean>
    
    <bean id="roleRevisorat" class="ch.vqf.cp.domain.security.Role">
    	<property name="name" value="Leiter Revisorat"></property>
    	<property name="members">
    		<list>
				<ref bean="benutzer5"></ref>
    		</list>
    	</property>
    	<property name="permissions">
    		<list>
    			<ref bean="perm7"></ref>
    			<ref bean="perm9"></ref>
    			<ref bean="perm10"></ref>
    			<ref bean="perm16"></ref>
    			<ref bean="perm17"></ref>
    			<ref bean="perm18"></ref>
    			<ref bean="perm10"></ref>
    		</list>
    	</property>
    </bean>
    
     <bean id="roleStrategy" class="ch.vqf.cp.startup.strategy.RoleStrategy" />
     
     <bean id="pruefungProvider" class="ch.vqf.cp.startup.provider.DefaultProvider">
		<property name="objectList">
			<list>
				<ref bean="pruefung1" />
				<ref bean="pruefung2" />
			</list>
		</property>
	</bean>
	
	<bean id="pruefung1" class="ch.vqf.cp.domain.Pruefung">
		<property name="mitglied" ref="mitglied1"></property>
		<property name="pruefer" ref="pruefer1"></property>
	</bean>
	
	<bean id="pruefung2" class="ch.vqf.cp.domain.Pruefung">
		<property name="mitglied" ref="mitglied2"></property>
		<property name="pruefer" ref="pruefer2"></property>
	</bean>
	
	<bean id="pruefungStrategy" class="ch.vqf.cp.startup.strategy.PruefungStrategy" />
	
	 <bean id="addressProvider" class="ch.vqf.cp.startup.provider.DefaultProvider">
		<property name="objectList">
			<list>
				<ref bean="adresse1" />
				<ref bean="adresse2" />
			</list>
		</property>
	</bean>
	
	<bean id="adresse1" class="ch.vqf.cp.domain.Adresse">
		<property name="adresstyp" value="pruefungsadresse"></property>
    	<property name="strasse" value="Schachenallee"></property>
    	<property name="hausnummer" value="123"></property>
    	<property name="plz" value="5000"></property>
    	<property name="ort" value="Aarau"></property>
    </bean>
    
    <bean id="adresse2" class="ch.vqf.cp.domain.Adresse">
    	<property name="adresstyp" value="pruefungsadresse"></property>
    	<property name="strasse" value="Baarerstrasse"></property>
    	<property name="hausnummer" value="111"></property>
    	<property name="plz" value="8000"></property>
    	<property name="ort" value="Zug"></property>
    </bean>
    
    <bean id="addressStrategy" class="ch.vqf.cp.startup.strategy.AddressStrategy" />
    
    <bean id="mailSender" class="org.springframework.mail.javamail.JavaMailSenderImpl">
  		<property name="host" value="localhost" />
  		<property name="port" value="26" />
	</bean>
    
</beans>
                        