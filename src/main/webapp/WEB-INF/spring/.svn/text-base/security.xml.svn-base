<?xml version="1.0" encoding="UTF-8"?>

<beans:beans xmlns="http://www.springframework.org/schema/security"
    xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
                        http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.0.xsd">

    <global-method-security pre-post-annotations="enabled">
        <!-- AspectJ pointcut expression that locates our "post" method and applies security that way
        <protect-pointcut expression="execution(* bigbank.*Service.post*(..))" access="ROLE_TELLER"/>
        -->
    </global-method-security>


    <http use-expressions="true">
    	<!-- Limit access to all sites in folder restricted, order matters!!! List most specific rule on top! -->
    	
    	
        <!-- <intercept-url pattern="/userManagement.jsf" access="hasAnyRole('Administratorrecht')"/>-->
        <!--<intercept-url pattern="/roleManagement.jsf" access="hasAnyRole('Administratorrecht', 'Rollen hinzufÃ¼gen')"/>-->
        <!-- Disable web URI authorization, as we're using <global-method-security> and have @Secured the services layer instead
        <intercept-url pattern="/listAccounts.html" access="isRememberMe()" />
        <intercept-url pattern="/post.html" access="hasRole('ROLE_TELLER')" />
        -->
        <!-- <intercept-url pattern="/views/admin/prueferManagement.jsf" access="hasAnyRole('Navigation PrÃ¼fer')"/> -->
        <intercept-url pattern="/views/**" access="isAuthenticated()" />
        <intercept-url pattern="/**" access="permitAll()" />
	
		<!-- Custom login page -->
        <form-login login-page="/login.jsf" authentication-success-handler-ref="customSuccessHandler" />
        
        <!-- Custom logout page is the same as timeout page -->
        <logout />
        <remember-me />
        
        <!-- We redirect to a servlet here. See ch.vqf.cp.web.servlet.RedirectLoginPageServlet for details -->
        <session-management invalid-session-url="/logmein/">
        </session-management>

    </http>
    
    <!-- Use database as authentication provider. -->
    <authentication-manager>
         <authentication-provider user-service-ref="jdbcUserService">
         	<!-- Hash passwords with MD5 -->
         	<password-encoder hash="md5">
				<salt-source ref="saltSource" />
         	</password-encoder>
         </authentication-provider>
    </authentication-manager>
    
</beans:beans>
